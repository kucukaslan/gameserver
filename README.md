# dream

## Notes:
- I've used MySQL as a database (to be pedantic I used the MariaDB that comes with XAMPP)
- Database configuration is in [./config.properties](./config.properties) file, 
I will commit it for convenience with the test db credentials.



- to alter log level, change the relevant values [src/main/resources/application.properties](src/main/resources/application.properties)
My suggestion is not to set it to DEBUG or TRACE if the performance is important.
Though, I prefer setting this project to TRACE, and rest (`root`) to INFO.


## Build and Run
First the database must be created.
I've exported the database (structure) to [./extras/dream.sql](./extras/dream.sql) file.



```bash
# mvn clean package
mvn spring-boot:run
```
Test:
```bash
mvn test
```
## TODO
- [ ] using local cache instead of redis? (for now I'm not using redis)
TournamentCache has a built-in cache, but it is not persistent. Maybe I can use redis for that.
```java
    private Map<String, JSONObject> tournamentCacheByCode;
```
- [ ] make sure the tournament joint request queues are emptied after the tournament ends.
so that the next tournament can start with empty queues.
- [ ] User can join tournaments only if it has enough coins to join.
- [ ] The user can earn coins only for completing level or winning (ranked 1st or 2nd) tournament.
- [ ] should add checks for whether user is joined to tournament
- [ ] implement claim award

## Questions
- [ ] endpoint access control (should require tokens?)
- [ ] verify: server will convert its time to UTC and process tournament events accordingly
- [ ] should the time of the event be the time received by the server or the time the event was generated by the client? \
    this is important when there is significant time difference between the server and the client. e.g. player finished a level at 19.59.59.999 but the server received the event at 20.00.00.001 \
    Furthermore if there is ability to play offline then user may play in midday and then connect to the server in the evening to see that his progress was not counted for tournament. 

- [ ] It seems sending request to enter the tournament is (blocking) action for the client. i.e. server will have it wait until the tournament  group is formed.  
- [ ] similarly should server immediately anounce the results or wait for some buffer time to complete tasks being processed?
- [ ] GetGroupLeaderboardRequest: can I assume that the client will always send the group code? or should I add a check for that to retrieve by user?

## Journal
There is also [Journal.md](Journal.md) file that I kept while working on this project. 
It is like a diary or an informal `git history`.